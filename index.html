<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°–≤—è—Ç–µ –ü–∏—Å–∞–Ω–Ω—è - –û–Ω–ª–∞–π–Ω —á–∏—Ç–∞–ª–∫–∞</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            color: #1e3c72;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            color: #666;
            font-size: 1.1em;
        }

        .controls {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .control-group {
            display: flex;
            flex-direction: column;
        }

        .control-group label {
            font-weight: 600;
            margin-bottom: 8px;
            color: #1e3c72;
        }

        select, input {
            padding: 12px;
            border: 2px solid #e0e6ed;
            border-radius: 10px;
            font-size: 16px;
            background: white;
            transition: all 0.3s ease;
        }

        select:focus, input:focus {
            outline: none;
            border-color: #2a5298;
            box-shadow: 0 0 0 3px rgba(42, 82, 152, 0.1);
        }

        .search-group {
            grid-column: 1 / -1;
            display: flex;
            gap: 10px;
        }

        .search-group input {
            flex: 1;
        }

        .btn {
            padding: 12px 24px;
            background: linear-gradient(135deg, #1e3c72, #2a5298);
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .content {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            min-height: 400px;
        }

        .verse {
            margin-bottom: 15px;
            padding: 15px;
            background: rgba(30, 60, 114, 0.05);
            border-left: 4px solid #2a5298;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .verse:hover {
            background: rgba(30, 60, 114, 0.08);
            transform: translateX(5px);
        }

        .verse-number {
            font-weight: bold;
            color: #1e3c72;
            margin-right: 10px;
            font-size: 0.9em;
        }

        .verse-text {
            line-height: 1.6;
            font-size: 1.1em;
        }

        .chapter-title {
            font-size: 1.8em;
            color: #1e3c72;
            margin-bottom: 20px;
            text-align: center;
            font-weight: 700;
        }

        .loading {
            text-align: center;
            color: #666;
            font-style: italic;
            padding: 40px;
        }

        .error {
            background: #fee;
            color: #c33;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #c33;
        }

        .search-result {
            background: #fff9c4;
            border-left: 4px solid #f39c12;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
            gap: 10px;
        }

        .nav-btn {
            padding: 10px 20px;
            background: rgba(30, 60, 114, 0.1);
            border: 2px solid #2a5298;
            color: #1e3c72;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .nav-btn:hover {
            background: #2a5298;
            color: white;
        }

        .nav-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .controls {
                grid-template-columns: 1fr;
            }
            
            .search-group {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>‚úùÔ∏è –°–≤—è—Ç–µ –ü–∏—Å–∞–Ω–Ω—è</h1>
            <p>–ß–∏—Ç–∞–π—Ç–µ –°–ª–æ–≤–æ –ë–æ–∂–µ –æ–Ω–ª–∞–π–Ω</p>
        </div>

        <div class="controls">
            <div class="control-group">
                <label for="bookSelect">–ö–Ω–∏–≥–∞:</label>
                <select id="bookSelect">
                    <option value="">–û–±–µ—Ä—ñ—Ç—å –∫–Ω–∏–≥—É...</option>
                </select>
            </div>
            
            <div class="control-group">
                <label for="chapterSelect">–†–æ–∑–¥—ñ–ª:</label>
                <select id="chapterSelect" disabled>
                    <option value="">–°–ø–æ—á–∞—Ç–∫—É –æ–±–µ—Ä—ñ—Ç—å –∫–Ω–∏–≥—É</option>
                </select>
            </div>

            <div class="search-group">
                <input type="text" id="searchInput" placeholder="–ü–æ—à—É–∫ –ø–æ —Ç–µ–∫—Å—Ç—É –°–≤—è—Ç–æ–≥–æ –ü–∏—Å–∞–Ω–Ω—è...">
                <button class="btn" onclick="searchBible()">–ó–Ω–∞–π—Ç–∏</button>
                <button class="btn" onclick="clearSearch()">–û—á–∏—Å—Ç–∏—Ç–∏</button>
            </div>
        </div>

        <div class="content" id="content">
            <div class="loading">
                üìñ –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –°–≤—è—Ç–æ–≥–æ –ü–∏—Å–∞–Ω–Ω—è...<br>
                <small>–ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—å, —â–æ —Ñ–∞–π–ª bible_ua.json –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ —Ç—ñ–π –∂–µ –ø–∞–ø—Ü—ñ</small>
            </div>
        </div>
    </div>

    <script>
        // BibleAPI –∑ –≤–∞—à–æ–≥–æ —Ñ–∞–π–ª—É
        const BibleAPI = {
            data: [],

            async load(url) {
                const response = await fetch(url);
                this.data = await response.json();
                return this.data;
            },

            getBooks() {
                return this.data.map(book => ({
                    number: book.number,
                    shortName: book.shortName,
                    name: book.name
                }));
            },

            getChapters(bookNumber) {
                const book = this.data.find(b => b.number === String(bookNumber));
                return book ? book.chapters.map(ch => ch.number) : [];
            },

            getVerses(bookNumber, chapterNumber) {
                const book = this.data.find(b => b.number === String(bookNumber));
                if (!book) return [];
                const chapter = book.chapters.find(ch => ch.number === String(chapterNumber));
                return chapter ? chapter.verses : [];
            },

            getVerse(bookNumber, chapterNumber, verseNumber) {
                return this.getVerses(bookNumber, chapterNumber)
                    .find(v => v.number === String(verseNumber)) || null;
            },

            search(query) {
                const results = [];
                const q = query.toLowerCase();
                for (const book of this.data) {
                    for (const chapter of book.chapters) {
                        for (const verse of chapter.verses) {
                            if (verse.text.toLowerCase().includes(q)) {
                                results.push({
                                    book: book.name,
                                    bookNumber: book.number,
                                    chapter: chapter.number,
                                    verse: verse.number,
                                    text: verse.text
                                });
                            }
                        }
                    }
                }
                return results;
            }
        };

        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let currentBook = null;
        let currentChapter = null;
        let searchResults = [];
        let isSearchMode = false;

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        async function init() {
            try {
                await BibleAPI.load('bible_ua.json');
                loadBooks();
                showWelcome();
            } catch (error) {
                showError('–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è: ' + error.message);
            }
        }

        function showError(message) {
            document.getElementById('content').innerHTML = `
                <div class="error">
                    ‚ùå ${message}<br><br>
                    –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —á–∏ –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è —Ñ–∞–π–ª <strong>bible_ua.json</strong> –≤ —Ç—ñ–π –∂–µ –ø–∞–ø—Ü—ñ —â–æ —ñ —Ü—è —Å—Ç–æ—Ä—ñ–Ω–∫–∞.<br>
                    –¢–∞–∫–æ–∂ –ø–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—å, —â–æ –≤–∏ –∑–∞–ø—É—Å—Ç–∏–ª–∏ Chrome –∑ –≤—ñ–¥–∫–ª—é—á–µ–Ω–∏–º CORS.
                </div>
            `;
        }

        function showWelcome() {
            document.getElementById('content').innerHTML = `
                <div style="text-align: center; padding: 40px;">
                    <h2 style="color: #1e3c72; margin-bottom: 20px;">–í—ñ—Ç–∞—î–º–æ –≤ –æ–Ω–ª–∞–π–Ω —á–∏—Ç–∞–ª—Ü—ñ –ë—ñ–±–ª—ñ—ó! üìñ</h2>
                    <p style="font-size: 1.2em; line-height: 1.6; color: #666;">
                        ‚ú® –û–±–µ—Ä—ñ—Ç—å –∫–Ω–∏–≥—É —Ç–∞ —Ä–æ–∑–¥—ñ–ª –∑–≤–µ—Ä—Ö—É, —â–æ–± –ø–æ—á–∞—Ç–∏ —á–∏—Ç–∞–Ω–Ω—è<br>
                        üîç –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –ø–æ—à—É–∫ –¥–ª—è –∑–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏—Ö –≤—ñ—Ä—à—ñ–≤<br>
                        üìö –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ <strong>${BibleAPI.data.length}</strong> –∫–Ω–∏–≥ –°–≤—è—Ç–æ–≥–æ –ü–∏—Å–∞–Ω–Ω—è
                    </p>
                </div>
            `;
        }

        function loadBooks() {
            const bookSelect = document.getElementById('bookSelect');
            const books = BibleAPI.getBooks();
            
            bookSelect.innerHTML = '<option value="">–û–±–µ—Ä—ñ—Ç—å –∫–Ω–∏–≥—É...</option>';
            books.forEach(book => {
                const option = document.createElement('option');
                option.value = book.number;
                option.textContent = book.name;
                bookSelect.appendChild(option);
            });
        }

        function loadChapters() {
            const bookNumber = document.getElementById('bookSelect').value;
            const chapterSelect = document.getElementById('chapterSelect');
            
            if (!bookNumber) {
                chapterSelect.innerHTML = '<option value="">–°–ø–æ—á–∞—Ç–∫—É –æ–±–µ—Ä—ñ—Ç—å –∫–Ω–∏–≥—É</option>';
                chapterSelect.disabled = true;
                return;
            }

            const chapters = BibleAPI.getChapters(bookNumber);
            chapterSelect.innerHTML = '<option value="">–û–±–µ—Ä—ñ—Ç—å —Ä–æ–∑–¥—ñ–ª...</option>';
            chapters.forEach(chapterNum => {
                const option = document.createElement('option');
                option.value = chapterNum;
                option.textContent = `–†–æ–∑–¥—ñ–ª ${chapterNum}`;
                chapterSelect.appendChild(option);
            });
            
            chapterSelect.disabled = false;
            currentBook = bookNumber;
        }

        function loadChapter() {
            const bookNumber = document.getElementById('bookSelect').value;
            const chapterNumber = document.getElementById('chapterSelect').value;
            
            if (!bookNumber || !chapterNumber) return;
            
            isSearchMode = false;
            currentBook = bookNumber;
            currentChapter = chapterNumber;
            
            const book = BibleAPI.data.find(b => b.number === String(bookNumber));
            const verses = BibleAPI.getVerses(bookNumber, chapterNumber);
            
            let html = `
                <div class="chapter-title">${book.name} ${chapterNumber}</div>
                <div class="navigation">
                    <button class="nav-btn" onclick="previousChapter()" ${!canGoPrevious() ? 'disabled' : ''}>
                        ‚Üê –ü–æ–ø–µ—Ä–µ–¥–Ω—ñ–π —Ä–æ–∑–¥—ñ–ª
                    </button>
                    <button class="nav-btn" onclick="nextChapter()" ${!canGoNext() ? 'disabled' : ''}>
                        –ù–∞—Å—Ç—É–ø–Ω–∏–π —Ä–æ–∑–¥—ñ–ª ‚Üí
                    </button>
                </div>
            `;
            
            verses.forEach(verse => {
                html += `
                    <div class="verse">
                        <span class="verse-number">${verse.number}</span>
                        <span class="verse-text">${verse.text}</span>
                    </div>
                `;
            });
            
            document.getElementById('content').innerHTML = html;
        }

        function searchBible() {
            const query = document.getElementById('searchInput').value.trim();
            if (!query) return;
            
            isSearchMode = true;
            searchResults = BibleAPI.search(query);
            
            if (searchResults.length === 0) {
                document.getElementById('content').innerHTML = `
                    <div style="text-align: center; padding: 40px;">
                        <h3>üîç –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –ø–æ—à—É–∫—É</h3>
                        <p>–ù–∞ –∂–∞–ª—å, –∑–∞ –∑–∞–ø–∏—Ç–æ–º "<strong>${query}</strong>" –Ω—ñ—á–æ–≥–æ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ.</p>
                        <p>–°–ø—Ä–æ–±—É–π—Ç–µ —ñ–Ω—à—ñ —Å–ª–æ–≤–∞ –∞–±–æ —Ñ—Ä–∞–∑–∏.</p>
                    </div>
                `;
                return;
            }
            
            let html = `
                <div class="chapter-title">üîç –ó–Ω–∞–π–¥–µ–Ω–æ: ${searchResults.length} –≤—ñ—Ä—à—ñ–≤</div>
                <p style="text-align: center; margin-bottom: 30px; color: #666;">
                    –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –ø–æ—à—É–∫—É –∑–∞ –∑–∞–ø–∏—Ç–æ–º: "<strong>${query}</strong>"
                </p>
            `;
            
            searchResults.forEach(result => {
                const highlightedText = result.text.replace(
                    new RegExp(query, 'gi'), 
                    `<mark style="background: #ffeb3b; padding: 2px 4px; border-radius: 3px;">$&</mark>`
                );
                
                html += `
                    <div class="verse search-result">
                        <div style="font-weight: bold; color: #1e3c72; margin-bottom: 5px;">
                            ${result.book} ${result.chapter}:${result.verse}
                        </div>
                        <span class="verse-text">${highlightedText}</span>
                    </div>
                `;
            });
            
            document.getElementById('content').innerHTML = html;
        }

        function clearSearch() {
            document.getElementById('searchInput').value = '';
            if (isSearchMode) {
                isSearchMode = false;
                if (currentBook && currentChapter) {
                    loadChapter();
                } else {
                    showWelcome();
                }
            }
        }

        function canGoPrevious() {
            if (!currentBook || !currentChapter) return false;
            const chapters = BibleAPI.getChapters(currentBook);
            const currentIndex = chapters.indexOf(String(currentChapter));
            return currentIndex > 0 || parseInt(currentBook) > 1;
        }

        function canGoNext() {
            if (!currentBook || !currentChapter) return false;
            const chapters = BibleAPI.getChapters(currentBook);
            const currentIndex = chapters.indexOf(String(currentChapter));
            return currentIndex < chapters.length - 1 || parseInt(currentBook) < BibleAPI.data.length;
        }

        function previousChapter() {
            if (!canGoPrevious()) return;
            
            const chapters = BibleAPI.getChapters(currentBook);
            const currentIndex = chapters.indexOf(String(currentChapter));
            
            if (currentIndex > 0) {
                // Previous chapter in same book
                currentChapter = chapters[currentIndex - 1];
            } else {
                // Last chapter of previous book
                const prevBookNumber = String(parseInt(currentBook) - 1);
                const prevChapters = BibleAPI.getChapters(prevBookNumber);
                currentBook = prevBookNumber;
                currentChapter = prevChapters[prevChapters.length - 1];
            }
            
            updateSelectors();
            loadChapter();
        }

        function nextChapter() {
            if (!canGoNext()) return;
            
            const chapters = BibleAPI.getChapters(currentBook);
            const currentIndex = chapters.indexOf(String(currentChapter));
            
            if (currentIndex < chapters.length - 1) {
                // Next chapter in same book
                currentChapter = chapters[currentIndex + 1];
            } else {
                // First chapter of next book
                const nextBookNumber = String(parseInt(currentBook) + 1);
                currentBook = nextBookNumber;
                currentChapter = "1";
            }
            
            updateSelectors();
            loadChapter();
        }

        function updateSelectors() {
            document.getElementById('bookSelect').value = currentBook;
            loadChapters();
            document.getElementById('chapterSelect').value = currentChapter;
        }

        // Event listeners
        document.getElementById('bookSelect').addEventListener('change', loadChapters);
        document.getElementById('chapterSelect').addEventListener('change', loadChapter);
        document.getElementById('searchInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                searchBible();
            }
        });

        // –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        init();
    </script>
</body>
</html>
